machine:
  services:
    - docker

dependencies:
  override:
    - docker build --rm=false -f uk.Dockerfile -t chaliy/ner-ms:uk .
    - docker build --rm=false -f en.Dockerfile -t chaliy/ner-ms:en .
    - docker build --rm=false -f ru.Dockerfile -t chaliy/ner-ms:ru .

test:
  override:
    - echo "No tests yet. Skipping..."

deployment:
  release:
    branch: master
    commands:
      - docker login -e $DOCKER_EMAIL -u $DOCKER_USER -p $DOCKER_PASS
      - docker push chaliy/ner-ms:uk
      - docker push chaliy/ner-ms:en
      - docker push chaliy/ner-ms:ru
      - docker tag chaliy/ner-ms:uk chaliy/ner-ms:latest
      - docker push chaliy/ner-ms:latest
